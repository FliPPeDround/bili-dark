<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <style>
      @import url('./checkbox.css');
    </style>
  </head>
  <body
    class="bg-gray-800 size-xs animated animated-zoom-in-down animated-fast text-gray-4"
  >
    <div class="">
      <header class="flex flex-col justify-center items-center">
        <div class="i-ant-design:bilibili-filled text-[#de4c67] text-6xl"></div>
        <div class="text-2xl c-lightBlue">Bili Dark</div>
      </header>
      <div class="switch-box">
        <input type="checkbox" id="dark" />
        <label class="switch" for="switch" />
      </div>
    </div>

    <script type="module">
      import 'virtual:uno.css'
      import '@unocss/reset/tailwind.css'

      async function sendTheme(theme, event) {
        const window = await chrome.windows.getCurrent()
        const x = event.screenX - window.left
        const y = event.clientY

        const [tab] = await chrome.tabs.query({
          active: true,
          currentWindow: true,
        })

        const resp = await chrome.tabs.sendMessage(tab.id, {
          biliColorSchema: theme,
          targetPoint: [x, y],
        })
      }
      const el = document.querySelector('#dark')
      const setting = localStorage.getItem('bili-color-schema') || 'dark'
      el.checked = setting === 'dark'
      el.addEventListener('click', async (event) => {
        const theme = el.checked ? 'light' : 'dark'
        await sendTheme(theme, event)
      })
    </script>
  </body>
</html>
